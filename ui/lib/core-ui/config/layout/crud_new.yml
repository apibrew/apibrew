type: record
resource: Layout
namespace: ui
properties:
  name: Crud
  input:
    - name: namespace
      type: STRING
    - name: resourceName
      type: STRING
  defs:
    pageLayout:
      $import: Layout/Page
      title: "New ${resource}"
      actions:
        - label: Cancel
          action: navigate('..')
        - label: Save
          action: save()
      children:
    forEachProperty:
      - $import: Logic/Expression
        command: |
          const properties = $resource.properties
          render(properties.filter($special ? isSpecialProperty : not(isSpecialProperty)).map(elem => children[0]))
    form:
      $import: Context/RecordWithUpdate
      children:
        $import: defs.pageLayout
        children:
          - component: Box
            label: Properties
            children:
              $import: $.properties.defs.forEachProperty
              special: true
              children:
                $import: Input/TextField
          - component: Box
            label: System properties
            children:
              $import: $.properties.defs.forEachProperty
              special: false
              children:
                $import: Input/TextField
  layout:
    $import: Context/Resource
    params:
      namespace: $namespace
      resource: $resourceName
    children:
      - component: Layout/Router
        routes:
          - new:
              $import: $.properties.defs/form
          - ":id/update":
              $import: $.properties.defs/form
          - ":id/view":
              $import: $.properties.defs/form